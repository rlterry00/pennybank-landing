{"version":3,"sources":["../../src/utils/webpack-utils.ts"],"names":["createWebpackUtils","stage","program","assetRelativeRoot","vendorRegex","supportedBrowsers","directory","PRODUCTION","includes","isSSR","jsxRuntimeExists","reactHasJsxRuntime","makeExternalOnly","original","options","rule","include","makeInternalOnly","exclude","ident","loaders","json","loader","require","resolve","yaml","null","raw","style","miniCssExtract","MiniCssExtractPlugin","process","env","GATSBY_EXPERIMENTAL_DEV_SSR","hmr","css","sourceMap","camelCase","localIdentName","postcss","plugins","overrideBrowserslist","postcssOpts","autoprefixerPlugin","flexbox","find","plugin","postcssPlugin","flexbugs","file","name","url","limit","fallback","js","reactRuntime","cacheDirectory","path","join","rootDir","dependencies","eslint","schema","imports","exports","rules","modulesThatUseGatsby","test","modulePath","some","module","type","use","configFile","compact","jsOptions","babelrc","presets","sourceMaps","cacheIdentifier","JSON","stringify","browerslist","gatsbyPreset","version","VENDORS_TO_NOT_POLYFILL","doNotPolyfillRegex","RegExp","enforce","VIRTUAL_MODULES_BASE_PATH","fonts","images","media","miscAssets","browsers","restOptions","importLoaders","unshift","modules","internal","external","cssModules","builtinPlugins","minifyJs","terserOptions","TerserPlugin","cache","ie8","mangle","safari10","parse","ecma","compress","output","minifyCss","cssProcessorPluginOptions","preset","svgo","full","removeUselessDefs","addAttributesToSVGElement","addClassesToSVGElement","cleanupAttrs","cleanupEnableBackground","cleanupIDs","cleanupListOfValues","cleanupNumericValues","collapseGroups","convertColors","convertPathData","convertStyleToAttrs","convertTransform","inlineStyles","mergePaths","minifyStyles","moveElemsAttrsToGroup","moveGroupAttrsToElems","prefixIds","removeAttributesBySelector","removeAttrs","removeComments","removeDesc","removeDimensions","removeDoctype","removeEditorsNSData","removeElementsByAttr","removeEmptyAttrs","removeEmptyContainers","removeEmptyText","removeHiddenElems","removeMetadata","removeNonInheritableGroupAttrs","removeOffCanvasPaths","removeRasterImages","removeScriptElement","removeStyleElement","removeTitle","removeUnknownsAndDefaults","removeUnusedNS","removeUselessStrokeAndFill","removeXMLNS","removeXMLProcInst","reusePaths","sortAttrs","OptimizeCssAssetsPlugin","fastRefresh","ReactRefreshWebpackPlugin","overlay","extractText","moment","ignore","extractStats","GatsbyWebpackStatsExtractor","eslintGraphqlSchemaReload","GatsbyWebpackEslintGraphqlSchemaReload","virtualModules","GatsbyWebpackVirtualModules"],"mappings":"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","sourcesContent":["import * as path from \"path\"\nimport { Loader, RuleSetRule, Plugin } from \"webpack\"\nimport { GraphQLSchema } from \"graphql\"\nimport postcss from \"postcss\"\nimport autoprefixer from \"autoprefixer\"\nimport flexbugs from \"postcss-flexbugs-fixes\"\nimport TerserPlugin from \"terser-webpack-plugin\"\nimport MiniCssExtractPlugin from \"mini-css-extract-plugin\"\nimport OptimizeCssAssetsPlugin from \"optimize-css-assets-webpack-plugin\"\nimport ReactRefreshWebpackPlugin from \"@pmmmwh/react-refresh-webpack-plugin\"\nimport { getBrowsersList } from \"./browserslist\"\nimport semver from \"semver\"\n\nimport { GatsbyWebpackStatsExtractor } from \"./gatsby-webpack-stats-extractor\"\nimport { GatsbyWebpackEslintGraphqlSchemaReload } from \"./gatsby-webpack-eslint-graphql-schema-reload-plugin\"\nimport {\n  GatsbyWebpackVirtualModules,\n  VIRTUAL_MODULES_BASE_PATH,\n} from \"./gatsby-webpack-virtual-modules\"\n\nimport { builtinPlugins } from \"./webpack-plugins\"\nimport { IProgram, Stage } from \"../commands/types\"\nimport { eslintConfig } from \"./eslint-config\"\n\ntype LoaderResolver<T = {}> = (options?: T) => Loader\n\ntype LoaderOptions = Record<string, any>\ntype RuleFactory<T = {}> = (options?: T & LoaderOptions) => RuleSetRule\n\ntype ContextualRuleFactory<T = {}> = RuleFactory<T> & {\n  internal?: RuleFactory<T>\n  external?: RuleFactory<T>\n}\n\ntype PluginFactory = (...args: any) => Plugin\n\ntype BuiltinPlugins = typeof builtinPlugins\n\n/**\n * Utils that produce webpack `loader` objects\n */\ninterface ILoaderUtils {\n  json: LoaderResolver\n  yaml: LoaderResolver\n  null: LoaderResolver\n  raw: LoaderResolver\n\n  style: LoaderResolver\n  css: LoaderResolver\n  postcss: LoaderResolver<{\n    browsers?: Array<string>\n    overrideBrowserslist?: Array<string>\n    plugins?:\n      | Array<postcss.Plugin<any>>\n      | ((loader: Loader) => Array<postcss.Plugin<any>>)\n  }>\n\n  file: LoaderResolver\n  url: LoaderResolver\n  js: LoaderResolver\n  dependencies: LoaderResolver\n\n  miniCssExtract: LoaderResolver\n  imports: LoaderResolver\n  exports: LoaderResolver\n\n  eslint(schema: GraphQLSchema): Loader\n}\n\ninterface IModuleThatUseGatsby {\n  name: string\n  path: string\n}\n\ntype CssLoaderModuleOption = boolean | Record<string, any> | string\n\n/**\n * Utils that produce webpack rule objects\n */\ninterface IRuleUtils {\n  /**\n   * Handles JavaScript compilation via babel\n   */\n  js: RuleFactory<{ modulesThatUseGatsby?: Array<IModuleThatUseGatsby> }>\n  dependencies: RuleFactory<{\n    modulesThatUseGatsby?: Array<IModuleThatUseGatsby>\n  }>\n  yaml: RuleFactory\n  fonts: RuleFactory\n  images: RuleFactory\n  miscAssets: RuleFactory\n  media: RuleFactory\n\n  css: ContextualRuleFactory<{\n    browsers?: Array<string>\n    modules?: CssLoaderModuleOption\n  }>\n  cssModules: RuleFactory\n  postcss: ContextualRuleFactory<{ overrideBrowserOptions: Array<string> }>\n\n  eslint: (schema: GraphQLSchema) => RuleSetRule\n}\n\ntype PluginUtils = BuiltinPlugins & {\n  extractText: PluginFactory\n  uglify: PluginFactory\n  moment: PluginFactory\n  extractStats: PluginFactory\n  minifyJs: PluginFactory\n  minifyCss: PluginFactory\n  fastRefresh: PluginFactory\n  eslintGraphqlSchemaReload: PluginFactory\n  virtualModules: PluginFactory\n}\n\n/**\n * webpack atoms namespace\n */\ninterface IWebpackUtils {\n  loaders: ILoaderUtils\n\n  rules: IRuleUtils\n\n  plugins: PluginUtils\n}\n\n/**\n * A factory method that produces an atoms namespace\n */\nexport const createWebpackUtils = (\n  stage: Stage,\n  program: IProgram\n): IWebpackUtils => {\n  const assetRelativeRoot = `static/`\n  const vendorRegex = /(node_modules|bower_components)/\n  const supportedBrowsers = getBrowsersList(program.directory)\n\n  const PRODUCTION = !stage.includes(`develop`)\n\n  const isSSR = stage.includes(`html`)\n\n  const jsxRuntimeExists = reactHasJsxRuntime()\n  const makeExternalOnly = (original: RuleFactory) => (\n    options = {}\n  ): RuleSetRule => {\n    const rule = original(options)\n    rule.include = vendorRegex\n    return rule\n  }\n\n  const makeInternalOnly = (original: RuleFactory) => (\n    options = {}\n  ): RuleSetRule => {\n    const rule = original(options)\n    rule.exclude = vendorRegex\n    return rule\n  }\n\n  let ident = 0\n\n  const loaders: ILoaderUtils = {\n    json: (options = {}) => {\n      return {\n        options,\n        loader: require.resolve(`json-loader`),\n      }\n    },\n\n    yaml: (options = {}) => {\n      return {\n        options,\n        loader: require.resolve(`yaml-loader`),\n      }\n    },\n\n    null: (options = {}) => {\n      return {\n        options,\n        loader: require.resolve(`null-loader`),\n      }\n    },\n\n    raw: (options = {}) => {\n      return {\n        options,\n        loader: require.resolve(`raw-loader`),\n      }\n    },\n\n    style: (options = {}) => {\n      return {\n        options,\n        loader: require.resolve(`style-loader`),\n      }\n    },\n\n    miniCssExtract: (options = {}) => {\n      if (PRODUCTION) {\n        // production always uses MiniCssExtractPlugin\n        return {\n          loader: MiniCssExtractPlugin.loader,\n          options,\n        }\n      } else if (process.env.GATSBY_EXPERIMENTAL_DEV_SSR) {\n        // develop with ssr also uses MiniCssExtractPlugin\n        return {\n          loader: MiniCssExtractPlugin.loader,\n          options: {\n            ...options,\n            // enable hmr for browser bundle, ssr bundle doesn't need it\n            hmr: stage === `develop`,\n          },\n        }\n      } else {\n        // develop without ssr is using style-loader\n        return {\n          loader: require.resolve(`style-loader`),\n          options,\n        }\n      }\n    },\n\n    css: (options = {}) => {\n      return {\n        loader: isSSR\n          ? require.resolve(`css-loader/locals`)\n          : require.resolve(`css-loader`),\n        options: {\n          sourceMap: !PRODUCTION,\n          camelCase: `dashesOnly`,\n          // https://github.com/webpack-contrib/css-loader/issues/406\n          localIdentName: `[name]--[local]--[hash:base64:5]`,\n          ...options,\n        },\n      }\n    },\n\n    postcss: (options = {}) => {\n      let {\n        plugins,\n        overrideBrowserslist = supportedBrowsers,\n        ...postcssOpts\n      } = options\n\n      return {\n        loader: require.resolve(`postcss-loader`),\n        options: {\n          ident: `postcss-${++ident}`,\n          sourceMap: !PRODUCTION,\n          plugins: (loader: Loader): Array<postcss.Plugin<any>> => {\n            plugins =\n              (typeof plugins === `function` ? plugins(loader) : plugins) || []\n\n            const autoprefixerPlugin = autoprefixer({\n              overrideBrowserslist,\n              flexbox: `no-2009`,\n              ...((plugins.find(\n                plugin => plugin.postcssPlugin === `autoprefixer`\n              ) as autoprefixer.Autoprefixer)?.options ?? {}),\n            })\n\n            return [flexbugs, autoprefixerPlugin, ...plugins]\n          },\n          ...postcssOpts,\n        },\n      }\n    },\n\n    file: (options = {}) => {\n      return {\n        loader: require.resolve(`file-loader`),\n        options: {\n          name: `${assetRelativeRoot}[name]-[hash].[ext]`,\n          ...options,\n        },\n      }\n    },\n\n    url: (options = {}) => {\n      return {\n        loader: require.resolve(`url-loader`),\n        options: {\n          limit: 10000,\n          name: `${assetRelativeRoot}[name]-[hash].[ext]`,\n          fallback: require.resolve(`file-loader`),\n          ...options,\n        },\n      }\n    },\n\n    js: options => {\n      return {\n        options: {\n          stage,\n          reactRuntime: jsxRuntimeExists ? `automatic` : `classic`,\n          cacheDirectory: path.join(\n            program.directory,\n            `.cache`,\n            `webpack`,\n            `babel`\n          ),\n          ...options,\n          rootDir: program.directory,\n        },\n        loader: require.resolve(`./babel-loader`),\n      }\n    },\n\n    dependencies: options => {\n      return {\n        options: {\n          cacheDirectory: path.join(\n            program.directory,\n            `.cache`,\n            `webpack`,\n            `babel`\n          ),\n          ...options,\n        },\n        loader: require.resolve(`babel-loader`),\n      }\n    },\n\n    eslint: (schema: GraphQLSchema) => {\n      const options = eslintConfig(schema, jsxRuntimeExists)\n\n      return {\n        options,\n        loader: require.resolve(`eslint-loader`),\n      }\n    },\n\n    imports: (options = {}) => {\n      return {\n        options,\n        loader: require.resolve(`imports-loader`),\n      }\n    },\n\n    exports: (options = {}) => {\n      return {\n        options,\n        loader: require.resolve(`exports-loader`),\n      }\n    },\n  }\n\n  /**\n   * Rules\n   */\n  const rules = {} as IRuleUtils\n\n  /**\n   * JavaScript loader via babel, includes userland code\n   * and packages that depend on `gatsby`\n   */\n  {\n    const js = ({\n      modulesThatUseGatsby = [],\n      ...options\n    }: {\n      modulesThatUseGatsby?: Array<IModuleThatUseGatsby>\n    } = {}): RuleSetRule => {\n      return {\n        test: /\\.(js|mjs|jsx)$/,\n        include: (modulePath: string): boolean => {\n          // when it's not coming from node_modules we treat it as a source file.\n          if (!vendorRegex.test(modulePath)) {\n            return true\n          }\n\n          // If the module uses Gatsby as a dependency\n          // we want to treat it as src so we can extract queries\n          return modulesThatUseGatsby.some(module =>\n            modulePath.includes(module.path)\n          )\n        },\n        type: `javascript/auto`,\n        use: [\n          loaders.js({\n            ...options,\n            configFile: true,\n            compact: PRODUCTION,\n          }),\n        ],\n      }\n    }\n    rules.js = js\n  }\n\n  /**\n   * Node_modules JavaScript loader via babel\n   * Excludes core-js & babel-runtime to speedup babel transpilation\n   * Excludes modules that use Gatsby since the `rules.js` already transpiles those\n   */\n  {\n    const dependencies = ({\n      modulesThatUseGatsby = [],\n    }: {\n      modulesThatUseGatsby?: Array<IModuleThatUseGatsby>\n    } = {}): RuleSetRule => {\n      const jsOptions = {\n        babelrc: false,\n        configFile: false,\n        compact: false,\n        presets: [\n          [\n            require.resolve(`babel-preset-gatsby/dependencies`),\n            {\n              stage,\n            },\n          ],\n        ],\n        // If an error happens in a package, it's possible to be\n        // because it was compiled. Thus, we don't want the browser\n        // debugger to show the original code. Instead, the code\n        // being evaluated would be much more helpful.\n        sourceMaps: false,\n\n        cacheIdentifier: JSON.stringify({\n          browerslist: supportedBrowsers,\n          gatsbyPreset: require(`babel-preset-gatsby/package.json`).version,\n        }),\n      }\n\n      // TODO REMOVE IN V3\n      // a list of vendors we know we shouldn't polyfill (we should have set core-js to entry but we didn't so we have to do this)\n      const VENDORS_TO_NOT_POLYFILL = [\n        `@babel[\\\\\\\\/]runtime`,\n        `@mikaelkristiansson[\\\\\\\\/]domready`,\n        `@reach[\\\\\\\\/]router`,\n        `babel-preset-gatsby`,\n        `core-js`,\n        `dom-helpers`,\n        `gatsby-legacy-polyfills`,\n        `gatsby-link`,\n        `gatsby-react-router-scroll`,\n        `invariant`,\n        `lodash`,\n        `mitt`,\n        `prop-types`,\n        `react-dom`,\n        `react`,\n        `regenerator-runtime`,\n        `scheduler`,\n        `scroll-behavior`,\n        `shallow-compare`,\n        `warning`,\n        `webpack`,\n      ]\n      const doNotPolyfillRegex = new RegExp(\n        `[\\\\\\\\/]node_modules[\\\\\\\\/](${VENDORS_TO_NOT_POLYFILL.join(\n          `|`\n        )})[\\\\\\\\/]`\n      )\n\n      return {\n        test: /\\.(js|mjs)$/,\n        exclude: (modulePath: string): boolean => {\n          // If dep is user land code, exclude\n          if (!vendorRegex.test(modulePath)) {\n            return true\n          }\n\n          // If dep uses Gatsby, exclude\n          if (\n            modulesThatUseGatsby.some(module =>\n              modulePath.includes(module.path)\n            )\n          ) {\n            return true\n          }\n\n          return doNotPolyfillRegex.test(modulePath)\n        },\n        type: `javascript/auto`,\n        use: [loaders.dependencies(jsOptions)],\n      }\n    }\n    rules.dependencies = dependencies\n  }\n\n  rules.eslint = (schema: GraphQLSchema): RuleSetRule => {\n    return {\n      enforce: `pre`,\n      test: /\\.jsx?$/,\n      exclude: (modulePath: string): boolean =>\n        modulePath.includes(VIRTUAL_MODULES_BASE_PATH) ||\n        vendorRegex.test(modulePath),\n      use: [loaders.eslint(schema)],\n    }\n  }\n\n  rules.yaml = (): RuleSetRule => {\n    return {\n      test: /\\.ya?ml$/,\n      use: [loaders.json(), loaders.yaml()],\n    }\n  }\n\n  /**\n   * Font loader\n   */\n  rules.fonts = (): RuleSetRule => {\n    return {\n      use: [loaders.url()],\n      test: /\\.(eot|otf|ttf|woff(2)?)(\\?.*)?$/,\n    }\n  }\n\n  /**\n   * Loads image assets, inlines images via a data URI if they are below\n   * the size threshold\n   */\n  rules.images = (): RuleSetRule => {\n    return {\n      use: [loaders.url()],\n      test: /\\.(ico|svg|jpg|jpeg|png|gif|webp|avif)(\\?.*)?$/,\n    }\n  }\n\n  /**\n   * Loads audio and video and inlines them via a data URI if they are below\n   * the size threshold\n   */\n  rules.media = (): RuleSetRule => {\n    return {\n      use: [loaders.url()],\n      test: /\\.(mp4|webm|ogv|wav|mp3|m4a|aac|oga|flac)$/,\n    }\n  }\n\n  /**\n   * Loads assets without inlining\n   */\n  rules.miscAssets = (): RuleSetRule => {\n    return {\n      use: [loaders.file()],\n      test: /\\.pdf$/,\n    }\n  }\n\n  /**\n   * CSS style loader.\n   */\n  {\n    const css: IRuleUtils[\"css\"] = (options = {}): RuleSetRule => {\n      const { browsers, ...restOptions } = options\n      const use = [\n        loaders.css({ ...restOptions, importLoaders: 1 }),\n        loaders.postcss({ browsers }),\n      ]\n      if (!isSSR)\n        use.unshift(\n          loaders.miniCssExtract({ hmr: !PRODUCTION && !restOptions.modules })\n        )\n\n      return {\n        use,\n        test: /\\.css$/,\n      }\n    }\n\n    /**\n     * CSS style loader, _excludes_ node_modules.\n     */\n    css.internal = makeInternalOnly(css)\n    css.external = makeExternalOnly(css)\n\n    const cssModules: IRuleUtils[\"cssModules\"] = (options): RuleSetRule => {\n      const rule = css({ ...options, modules: true })\n      delete rule.exclude\n      rule.test = /\\.module\\.css$/\n      return rule\n    }\n\n    rules.css = css\n    rules.cssModules = cssModules\n  }\n\n  /**\n   * PostCSS loader.\n   */\n  {\n    const postcss: ContextualRuleFactory = (options): RuleSetRule => {\n      return {\n        test: /\\.css$/,\n        use: [loaders.css({ importLoaders: 1 }), loaders.postcss(options)],\n      }\n    }\n\n    /**\n     * PostCSS loader, _excludes_ node_modules.\n     */\n    postcss.internal = makeInternalOnly(postcss)\n    postcss.external = makeExternalOnly(postcss)\n    rules.postcss = postcss\n  }\n  /**\n   * cast rules to IRuleUtils\n   */\n  /**\n   * Plugins\n   */\n  const plugins = { ...builtinPlugins } as PluginUtils\n\n  plugins.minifyJs = ({\n    terserOptions,\n    ...options\n  }: { terserOptions?: TerserPlugin.TerserPluginOptions } = {}): Plugin =>\n    new TerserPlugin({\n      // TODO add proper cache keys\n      cache: path.join(program.directory, `.cache`, `webpack`, `terser`),\n      exclude: /\\.min\\.js/,\n      sourceMap: true,\n      terserOptions: {\n        ie8: false,\n        mangle: {\n          safari10: true,\n        },\n        parse: {\n          ecma: 8,\n        },\n        compress: {\n          ecma: 5,\n        },\n        output: {\n          ecma: 5,\n        },\n        ...terserOptions,\n      },\n      ...options,\n    })\n\n  plugins.minifyCss = (\n    options = {\n      cssProcessorPluginOptions: {\n        preset: [\n          `default`,\n          {\n            svgo: {\n              full: true,\n              plugins: [\n                {\n                  // potentially destructive plugins removed - see https://github.com/gatsbyjs/gatsby/issues/15629\n                  // convertShapeToPath: true,\n                  // removeViewBox: true,\n                  removeUselessDefs: true,\n                  addAttributesToSVGElement: true,\n                  addClassesToSVGElement: true,\n                  cleanupAttrs: true,\n                  cleanupEnableBackground: true,\n                  cleanupIDs: true,\n                  cleanupListOfValues: true,\n                  cleanupNumericValues: true,\n                  collapseGroups: true,\n                  convertColors: true,\n                  convertPathData: true,\n                  convertStyleToAttrs: true,\n                  convertTransform: true,\n                  inlineStyles: true,\n                  mergePaths: true,\n                  minifyStyles: true,\n                  moveElemsAttrsToGroup: true,\n                  moveGroupAttrsToElems: true,\n                  prefixIds: true,\n                  removeAttributesBySelector: true,\n                  removeAttrs: true,\n                  removeComments: true,\n                  removeDesc: true,\n                  removeDimensions: true,\n                  removeDoctype: true,\n                  removeEditorsNSData: true,\n                  removeElementsByAttr: true,\n                  removeEmptyAttrs: true,\n                  removeEmptyContainers: true,\n                  removeEmptyText: true,\n                  removeHiddenElems: true,\n                  removeMetadata: true,\n                  removeNonInheritableGroupAttrs: true,\n                  removeOffCanvasPaths: true,\n                  removeRasterImages: true,\n                  removeScriptElement: true,\n                  removeStyleElement: true,\n                  removeTitle: true,\n                  removeUnknownsAndDefaults: true,\n                  removeUnusedNS: true,\n                  removeUselessStrokeAndFill: true,\n                  removeXMLNS: true,\n                  removeXMLProcInst: true,\n                  reusePaths: true,\n                  sortAttrs: true,\n                },\n              ],\n            },\n          },\n        ],\n      },\n    }\n  ): OptimizeCssAssetsPlugin => new OptimizeCssAssetsPlugin(options)\n\n  plugins.fastRefresh = (): Plugin =>\n    new ReactRefreshWebpackPlugin({\n      overlay: false,\n    })\n\n  plugins.extractText = (options: any): Plugin =>\n    new MiniCssExtractPlugin({\n      ...options,\n    })\n\n  plugins.moment = (): Plugin => plugins.ignore(/^\\.\\/locale$/, /moment$/)\n\n  plugins.extractStats = (): GatsbyWebpackStatsExtractor =>\n    new GatsbyWebpackStatsExtractor()\n\n  plugins.eslintGraphqlSchemaReload = (): GatsbyWebpackEslintGraphqlSchemaReload =>\n    new GatsbyWebpackEslintGraphqlSchemaReload()\n\n  plugins.virtualModules = (): GatsbyWebpackVirtualModules =>\n    new GatsbyWebpackVirtualModules()\n\n  return {\n    loaders,\n    rules,\n    plugins,\n  }\n}\n\nexport function reactHasJsxRuntime(): boolean {\n  // We've got some complains about the ecosystem not being ready for automatic so we disable it by default.\n  // People can use a custom babelrc file to support it\n  // try {\n  //   // React is shipping a new jsx runtime that is to be used with\n  //   // an option on @babel/preset-react called `runtime: automatic`\n  //   // Not every version of React has this jsx-runtime yet. Eventually,\n  //   // it will be backported to older versions of react and this check\n  //   // will become unnecessary.\n  //   // for now we also do the semver check until react 17 is more widely used\n  //   // const react = require(`react/package.json`)\n  //   // return (\n  //   //   !!require.resolve(`react/jsx-runtime.js`) &&\n  //   //   semver.major(react.version) >= 17\n  //   // )\n  // } catch (e) {\n  //   // If the require.resolve throws, that means this version of React\n  //   // does not support the jsx runtime.\n  // }\n\n  return false\n}\n"],"file":"webpack-utils.js"}